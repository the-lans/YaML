# Генератор текста

## **Конечные точки**

| №    | Конечная точка         | Тип  | Параметры                        | Response             | Описание                              |
| ---- | ---------------------- | ---- | -------------------------------- | -------------------- | ------------------------------------- |
| 1    | api/text/new           | GET  | name: str                        | QueryDB              | Новый запрос (статья)                 |
| 2    | api/text/next/{id}     | GET  | text: str, next: str, liner: str | text: str, next: str | Генерация следующего куска текста     |
| 3    | api/text/update/{id}   | GET  | text: str                        | text: str, next: str | Обновление существующего куска текста |
| 4    | api/template/new       | POST | name: str, file/json             | QueryTemplateDB      | Добавление шаблона                    |
| 5    | api/template/list      | GET  |                                  | QueryTemplateDB      | Список шаблонов                       |
| 6    | api/template/{id}      | GET  |                                  | QueryTemplateDB      | Получение шаблона                     |
| 7    | api/text/generate/{id} | GET  |                                  | QueryDB              | Генерация текста по шаблону           |
|      |                        |      |                                  |                      |                                       |

  

## **Заголовки**

| Key           | Value            | Описание          |
| ------------- | ---------------- | ----------------- |
| Authorization | Bearer …         | Токен авторизации |
| Content-Type  | application/json | Тип контента      |
|               |                  |                   |

  

## **Точки пересылки запросов**

| №    | Конечная точка                                | Тип  | Параметры                                  | Response                                                    |
| ---- | --------------------------------------------- | ---- | ------------------------------------------ | ----------------------------------------------------------- |
| 1    | https://zeapi.yandex.net/  lab/api/yalm/text3 | POST | query:  str,   intro:  int,   filter:  int | bad_query:  int,   error:  int,   query:  str,   text:  str |
|      |                                               |      |                                            |                                                             |

  

## База данных

### text_query

Model: QueryDB

| Поле        | Тип      | Описание                |
| ----------- | -------- | ----------------------- |
| id          | int      | Идентификатор запроса   |
| created     | datetime | Дата создания           |
| id_template | int      | Шаблон для создания     |
| name        | str      | Имя конкретного запроса |
| text        | str      | Сгенерированный текст   |
|             |          |                         |



### template_query

Model: QueryTemplateDB

| Поле    | Тип      | Описание               |
| ------- | -------- | ---------------------- |
| id      | int      | Идентификатор шаблона  |
| created | datetime | Дата создания          |
| name    | str      | Название шаблона       |
| hash    | str      | Хеш загружаемого файла |
|         |          |                        |



### template_rows

| Поле        | Тип  | Описание                                 |
| ----------- | ---- | ---------------------------------------- |
| id          | int  | Идентификатор записи                     |
| id_template | int  | Шаблон                                   |
| text        | str  | Автоподводка                             |
| symbols     | int  | Количество символов для генерации текста |
|             |      |                                          |



### text_history

| Поле     | Тип      | Описание                               |
| -------- | -------- | -------------------------------------- |
| id       | int      | Идентификатор записи                   |
| created  | datetime | Дата создания записи                   |
| id_query | int      | Запрос                                 |
| next     | str      | Сгенерированный текст на текущем шаге  |
| liner    | str      | Подводка                               |
| prod     | bool     | Текст используется в итоговом варианте |
|          |          |                                        |

